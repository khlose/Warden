<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<script src="../../../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
<script src="../../../bower_components/sweetalert/dist/sweetalert.min.js"></script>
<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/paper-material/paper-material.html">
<link rel="import" href="../../app-behaviors/app-localize-behavior.html">
<link rel="import" href="../../app-themes/current-theme/shared-styles/pages-shared-styles.html">
<link rel="import" href="../../../bower_components/google-map/google-map.html">
<link rel="import" href="../../../bower_components/google-map/google-map-directions.html">
<link rel="import" href="../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../../bower_components/iron-icons/maps-icons.html">
<link rel="import" href="../../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="stylesheet" href="../../../bower_components/sweetalert/dist/sweetalert.css">
<link rel="import" href="app-icons-home.html">

<dom-module id="app-page-home">

  <template>

    <style include="pages-shared-styles">

      :host {
        display: block;
      }

      /* Tablet wide */
      @media screen and (min-width: 600px) {

      }

      /* Laptop wide */
      @media screen and (min-width: 960px) {

      }

      /* Large wide */
      @media screen and (min-width: 1600px) {

      }

      /* Landscape phone height */
      @media screen and (orientation: landscape) and (max-height: 450px) {

      }

      /* Landscape phone minimal height - iPhone 4 */
      @media screen and (orientation: landscape) and (max-height: 320px) {

      }

      /* Print mode */
      @media print {

      }
      google-map{
        display: block;
        height: inherit;
        width: inherit;
      }
      .Map-container{
        box-sizing: border-box;
        height: 40vh;
        width: inherit;
        margin-top: 1vh;
      }
      .search-card{
        width: 100%;
        height: auto;
        z-index: 1;
        padding: 1vh;
      }
    </style>

    <div class="Page-container" id="section1">
      <paper-card class="search-card" elevation="2">
        
        <paper-icon-item>
          <iron-icon icon="search" item-icon></iron-icon>
          <paper-input label="Start address" value="{{start}}"></paper-input>
          <paper-icon-button raised on-tap="getlocation" icon="maps:my-location"></paper-icon-button>
        </paper-icon-item>
          
        <paper-icon-item>
          <iron-icon icon="search" item-icon></iron-icon>
          <paper-input label="End address" value="{{end}}"></paper-input>
        </paper-icon-item>

      </paper-card>
      <div class="Map-container" id="sectionMap">
        <google-map id="main-map" map="{{map}}" latitude="37.779" longitude="-122.3892" zoom="13" 
                    api-key="AIzaSyA8P5CDbf_5xkLRIHDjSJ3k2MXDYH4ffEw" disable-default-ui>
        </google-map>
        <google-map-directions id="map-directions" map="{{map}}" start-address="{{coord.start}}"
                               end-address="{{end}}"
                               api-key="AIzaSyA8P5CDbf_5xkLRIHDjSJ3k2MXDYH4ffEw">
        </google-map-directions>
      </div>
    </div>

  </template>

  <script>
    

    Polymer({

      is: 'app-page-home',
      properties: {
        active: {
          type: Boolean,
          value: false,
          observer: '_activeChanged'
        },

        app: Object,

        _isLocalesLoaded: {
          type: Boolean,
          value: false
        },
        coord: Object
      },

      behaviors: [
        AppBehaviors.AppLocalizeBehavior
      ],

      listeners: {
        'app-resources-loaded': '_onLocalesLoaded'
      },

      _activeChanged: function() {
        if (this.active) {
          if (this._isLocalesLoaded) {
            this.set('app.pageTitle', this.localize('home'));
          } else {
            this.loadLocales(this.is);
          }
        }
      },

      _onLocalesLoaded: function(event) {
        event.stopPropagation();
        this._isLocalesLoaded = true;
        // TODO: Resolve slow localize data binding in Firefox
        //this.style.display = 'block';
        this.set('app.pageTitle', this.localize('home'));
      },
      
      getlocation: function(){
        if(navigator.geolocation){
          navigator.geolocation.getCurrentPosition(function(position){
            this.coord = position.coords;
            console.log(this.coord.latitude);
            console.log(this.coord.longitude);
          });
        }
        else{
          sweetAlert({
            title: "Oops!", 
            text: "Geolocation is currently not supported by your browser/device!", 
            type: "error"
          });
        }
      }

    });

  </script>

</dom-module>
